<div class="container mt-4">
  <h2>User Management</h2>


  @if(errorMessage){
    <div class="alert alert-danger alert-dismissible fade show fixed-top mt-5 mx-auto rounded-lg shadow-lg text-center" style="width: 25%; max-width: 1200px; min-width: 250px;" role="alert">
      {{errorMessage}}
      <button type="button" class="btn-close" (click)="cancelDeletion()" aria-label="Close"></button>
    </div>
  }

  @if(successMessage){
    <div class="alert alert-success alert-dismissible fade show fixed-top mt-5 mx-auto rounded-lg shadow-lg text-center" style="width: 25%; max-width: 1200px; min-width: 250px;" role="alert">
      {{successMessage}}
      <button type="button" class="btn-close" aria-label="Close"></button>
    </div>
  }

  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>ID</th>
          <th>First name</th>
          <th>Last name</th>
          <th>Email</th>
          <th>Role</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        @for (user of users; track user._id) {
          <tr>
            <td>{{ user._id  }}</td>
            <td>{{ user.firstName}}</td>
            <td>{{ user.lastName }}</td>
            <td>{{ user.email }}</td>
            <td>
              @if(this.userId != user._id){
                <div class="form-check form-switch">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    role="switch"
                    id="role-{{user._id}}"
                    [checked]="user.role === 'ADMIN'"
                    (change)="toggleUserRole(user)"
                  >
                  <label class="form-check-label" for="role-{{user._id}}">
                    {{ user.role === 'ADMIN' ? 'Admin' : 'User' }}
                  </label>
                </div>
              }
            </td>
            <td>
              @if(this.userId != user._id){
                <button class="btn btn-sm btn-danger" (click)="deleteUser(user._id)">Delete</button>
              }
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
